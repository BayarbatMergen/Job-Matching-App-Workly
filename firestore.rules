rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // 모집 공고
    match /jobs/{jobId} {
      allow read: if request.auth != null;
      allow create, update, delete: if request.auth.token.role == "admin";
    }

    // 사용자 (본인만), 관리자 전체
    match /users/{userId} {
      allow read, write: if request.auth != null &&
        (request.auth.uid == userId || request.auth.token.role == "admin");
    }

    // 관리자 전용
    match /admins/{docId} {
      allow read, write: if request.auth.token.role == "admin";
    }

    // 로그인 유저 모두 가능 (각 match 별로 따로 정의)
    match /applications/{docId} {
      allow read, write: if request.auth != null;
    }

    match /chatRooms/{docId} {
      allow read, write: if request.auth != null;
    }

    match /chats/{docId} {
      allow read, write: if request.auth != null;
    }

    match /settlements/{docId} {
      allow read, write: if request.auth != null;
    }

    match /inquiries/{docId} {
      allow read, write: if request.auth != null;
    }

    match /notifications/{docId} {
      allow read, write: if request.auth != null;
    }
  }
}
